# Malware Finder #

A somewhat shitty python script which can analyze memory dumps using Volatility.

## TODO ##
* ~~Implement VirusTotal scanner~~
* ~~Save history per image based on image hash~~
* Cache builder: cache most common volatility commands for all specified images
* Configuration file to store Volatility path & VT API key etc. & config dir param

## Usage ##
```
usage: malware-finder.py [-h] [-v VOLATILITY] [-c CACHE] [-d DUMP]
                         [-p PROFILE] [-a VT_API_KEY] [-w VT_WORKERS]
                         image

positional arguments:
  image                 Path to the image to analyze

optional arguments:
  -h, --help            show this help message and exit
  -v VOLATILITY, --volatility VOLATILITY
                        Path to the volatility executable
  -c CACHE, --cache CACHE
                        Path to the caching directory
  -d DUMP, --dump DUMP  Path where to drop binary dumps
  -p PROFILE, --profile PROFILE
                        Image's volatility profile
  -a VT_API_KEY, --vt-api-key VT_API_KEY
                        VirusTotal API key
  -w VT_WORKERS, --vt-workers VT_WORKERS
                        Amount of VirusTotal workers
```

## Usage example ##
```
$ ./malware-finder.py images/image07.raw
SHA512 checksum: 0b290970eb65043e99310575f10585d4868cc4cd5234dcabbde891cf02a29e8dd218fa9f72f7ebce0a6e04125143a5bc04d90cb837b70bd2a8f9cbc2ca482fe4
Testing profile "Win7SP0x86"
Profile: Win7SP0x86
image07.raw> help
Internal commands:
* apihooks
* correlate
* dlllist
* evildll
* evilps
* hollow
* identify
* imageinfo
* ldrmodules
* malfind
* printkey_autostart
* pslist
* psxview
* strings
* vadinfo
* vt
image07.raw> :vt -p 1820
Executing "procdump --dump-dir=dump --pid=1820"
Uploading "dump/executable.1820.exe" (2.5 MiB) to VirusTotal
Detection rate: 2/56 (3%)
Scan date: 2017-01-28 15:11:16
URL: https://www.virustotal.com/file/e63ff30937f5ed6ecabea5d41338407dfb7d18e8a34347f48a2da4dd5a619530/analysis/1485616276/

Amount Malware
     1 HEUR/QVM10.1.0000.Malware.Gen
     1 malicious_confidence_89% (D)
image07.raw> :vt -p 2180 -a 1638400
Executing "dlldump --dump-dir=dump --pid=2180 --base=1638400"
Uploading "dump/module.2180.3fd9da58.190000.dll" (30.5 KiB) to VirusTotal
Detection rate: 3/57 (5%)
Scan date: 2017-01-28 15:30:37
URL: https://www.virustotal.com/file/a0a297b2b5d1089dc2c70674727e0a3ccecf3fd582a171562dacbc548622bbe1/analysis/1485617437/

Amount Malware
     1 HEUR/QVM40.1.0000.Malware.Gen
     1 malicious_confidence_84% (D)
     1 Packed.CPEX-based.cda
image07.raw> 
```
